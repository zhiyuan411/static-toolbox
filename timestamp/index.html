<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>时间戳转换工具 | Timestamp Converter</title>
  <!-- 引入Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 引入Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- 配置Tailwind自定义主题 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3B82F6',
            secondary: '#10B981',
            dark: '#1E293B',
            light: '#F8FAFC'
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <!-- 自定义工具类 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .transition-custom {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .shadow-custom {
        box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.1), 0 8px 10px -6px rgba(59, 130, 246, 0.1);
      }
      .gradient-bg {
        background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);
      }
    }
  </style>
</head>
<body class="font-inter bg-gray-50 min-h-screen text-dark flex flex-col">
  <!-- 页面头部 -->
  <header class="gradient-bg text-white shadow shadow-lg">
    <div class="container mx-auto px-4 py-6 md:py-8">
      <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold tracking-tight">
        <i class="fa fa-clock-o mr-2" aria-hidden="true"></i>时间戳转换工具
      </h1>
      <p class="mt-2 text-blue-100 max-w-2xl">轻松在时间戳与日期格式之间进行转换，支持多种种格式识别与双向转换</p>
    </div>
  </header>

  <!-- 主要内容 -->
  <main class="flex-grow container mx-auto px-4 py-8 md:py-12">
    <div class="max-w-4xl mx-auto">
      <!-- 输入区域 -->
      <div class="bg-white rounded-xl-xl shadow shadow-custom p-6 mb-8 transform hover:scale-[1.01] transition-custom">
        <label for="inputValue" class="block text-sm font-medium text-gray-700 mb-2">输入时间戳或日期</label>
        <div class="flex flex-col sm:flex-row gap-3">
          <input 
            type="text" 
            id="inputValue" 
            class="flex-grow px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-custom"
            placeholder="回车触发转换，例如：1620000000、1620000000000、2023-05-01 12:30 等"
          >
          <div class="flex gap-2">
            <button id="clearBtn" class="px-4 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition-custom flex items-center">
              <i class="fa fa-eraser mr-1" aria-hidden="true"></i> 清空
            </button>
            <button id="convertBtn" class="px-4 py-3 bg-primary hover:bg-primary/90 text-white rounded-lg-lg transition-custom flex items-center">
              <i class="fa fa-exchange mr-1" aria-hidden="true"></i> 转换
            </button>
          </div>
        </div>
        
        <!-- 快捷按钮 -->
        <div class="mt-4 flex flex-wrap gap-2">
          <button id="currentMsBtn" class="px-3 py-1.5 text-sm bg-blue-100 hover:bg-blue-200 text-primary rounded-md transition-custom">
            <i class="fa fa-bolt mr-1" aria-hidden="true"></i> 当前时间戳
          </button>
          <button id="currentDateBtn" class="px-3 py-1.5 text-sm bg-green-100 hover:bg-green-200 text-green-700 rounded-md transition-custom">
            <i class="fa fa-calendar mr-1" aria-hidden="true"></i> 当前日期
          </button>
        </div>
      </div>
      
      <!-- 结果区域 -->
      <div id="resultContainer" class="grid grid-cols-1 md:grid-cols-2 gap-6 opacity-0 transition-custom duration-500">
        <!-- 时间戳转换结果 -->
        <div id="timestampResult" class="bg-white rounded-xl shadow-custom p-6 transform hover:translate-y-[-5px] transition-custom">
          <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <i class="fa fa-calendar-check-o text-primary mr-2" aria-hidden="true"></i>
            日期时间结果
          </h2>
          <div class="space-y-4">
            <div>
              <p class="text-sm text-gray-500 mb-1">本地时区</p>
              <div class="flex items-center">
                <p id="localDateTime" class="text-gray-800 font-medium flex-grow break-all">--</p>
                <button class="copy-btn text-gray-400 hover:text-primary transition-custom" data-target="localDateTime">
                  <i class="fa fa-copy" aria-hidden="true"></i>
                </button>
              </div>
            </div>
            <div>
              <p class="text-sm text-gray-500 mb-1">UTC时区</p>
              <div class="flex items-center">
                <p id="utcDateTime" class="text-gray-800 font-medium flex-grow break-all">--</p>
                <button class="copy-btn text-gray-400 hover:text-primary transition-custom" data-target="utcDateTime">
                  <i class="fa fa-copy" aria-hidden="true"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 日期转换结果 -->
        <div id="dateResult" class="bg-white rounded-xl shadow-custom p-6 transform hover:translate-y-[-5px] transition-custom">
          <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
            <i class="fa fa-hashtag text-secondary mr-2" aria-hidden="true"></i>
            时间戳结果
          </h2>
          <div class="space-y-4">
            <div>
              <p class="text-sm text-gray-500 mb-1">秒级时间戳 (10位)</p>
              <div class="flex items-center">
                <p id="secondTimestamp" class="text-gray-800 font-medium flex-grow break-all">--</p>
                <button class="copy-btn text-gray-400 hover:text-primary transition-custom" data-target="secondTimestamp">
                  <i class="fa fa-copy" aria-hidden="true"></i>
                </button>
              </div>
            </div>
            <div>
              <p class="text-sm text-gray-500 mb-1">毫秒级时间戳 (13位)</p>
              <div class="flex items-center">
                <p id="millisecondTimestamp" class="text-gray-800 font-medium flex-grow break-all">--</p>
                <button class="copy-btn text-gray-400 hover:text-primary transition-custom" data-target="millisecondTimestamp">
                  <i class="fa fa-copy" aria-hidden="true"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 转换信息 -->
      <div class="bg-blue-50 border border-blue-100 rounded-xl p-5 mt-6">
        <h3 class="font-medium text-primary flex items-center">
          <i class="fa fa-info-circle mr-2" aria-hidden="true"></i>支持的格式
        </h3>
        <ul class="mt-2 text-sm text-gray-600 space-y-1">
          <li><i class="fa fa-check text-green-500 mr-1" aria-hidden="true"></i> 10位秒级时间戳 (例如: 1620000000)</li>
          <li><i class="fa fa-check text-green-500 mr-1" aria-hidden="true"></i> 13位毫秒级时间戳 (例如: 1620000000000)</li>
          <li><i class="fa fa-check text-green-500 mr-1" aria-hidden="true"></i> 日期格式 (例如: 2023-05-01、2023/05/01、01/05/2023)</li>
          <li><i class="fa fa-check text-green-500 mr-1" aria-hidden="true"></i> 带时间的日期 (例如: 2023-05-01 12:30、2023/05/01 12:30:45)</li>
        </ul>
      </div>
    </div>
  </main>

  <!-- 通知提示 -->
  <div id="notification" class="fixed bottom-5 right-5 bg-dark text-white px-4 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-custom flex items-center">
    <i id="notificationIcon" class="fa fa-check-circle mr-2 text-green-400" aria-hidden="true"></i>
    <span id="notificationText"></span>
  </div>

  <script>
    // DOM元素
    const inputValue = document.getElementById('inputValue');
    const clearBtn = document.getElementById('clearBtn');
    const convertBtn = document.getElementById('convertBtn');
    const currentMsBtn = document.getElementById('currentMsBtn');
    const currentDateBtn = document.getElementById('currentDateBtn');
    const resultContainer = document.getElementById('resultContainer');
    const localDateTime = document.getElementById('localDateTime');
    const utcDateTime = document.getElementById('utcDateTime');
    const secondTimestamp = document.getElementById('secondTimestamp');
    const millisecondTimestamp = document.getElementById('millisecondTimestamp');
    const copyButtons = document.querySelectorAll('.copy-btn');
    const notification = document.getElementById('notification');
    const notificationText = document.getElementById('notificationText');
    const notificationIcon = document.getElementById('notificationIcon');

    // 显示通知
    function showNotification(message, isSuccess = true) {
      notificationText.textContent = message;
      notificationIcon.className = isSuccess 
        ? 'fa fa-check-circle mr-2 text-green-400' 
        : 'fa fa-exclamation-circle mr-2 text-red-400';
      
      notification.classList.remove('translate-y-20', 'opacity-0');
      notification.classList.add('translate-y-0', 'opacity-100');
      
      setTimeout(() => {
        notification.classList.remove('translate-y-0', 'opacity-100');
        notification.classList.add('translate-y-20', 'opacity-0');
      }, 2000);
    }

    // 传统复制方法（使用 textarea 和 execCommand）
    function fallbackCopyText(text) {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.position = "fixed";
        textArea.style.opacity = "0";
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();

        try {
            const successful = document.execCommand('copy');
            if (successful) {
                showNotification('文本复制成功！');
            } else {
                throw new Error('execCommand 复制失败');
            }
        } catch (err) {
            console.error('复制失败:', err);
            showNotification('复制失败，请手动复制', false);
        } finally {
            document.body.removeChild(textArea);
        }
    }

    // 复制到剪贴板 - 使用现代API并在失败时回退到传统方法
    function copyToClipboard(text) {
      // 先尝试现代API
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text)
          .then(() => showNotification('复制成功'))
          .catch(() => {
            // 现代API失败，使用传统方法
            fallbackCopyText(text);
          });
      } else {
        // 不支持现代API，直接使用传统方法
        fallbackCopyText(text);
      }
    }

    // 格式化日期为字符串
    function formatDate(date) {
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      const hours = String(date.getHours()).padStart(2, '0');
      const minutes = String(date.getMinutes()).padStart(2, '0');
      const seconds = String(date.getSeconds()).padStart(2, '0');
      
      return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
    }

    // 格式化UTC日期为字符串
    function formatUTCDate(date) {
      const year = date.getUTCFullYear();
      const month = String(date.getUTCMonth() + 1).padStart(2, '0');
      const day = String(date.getUTCDate()).padStart(2, '0');
      const hours = String(date.getUTCHours()).padStart(2, '0');
      const minutes = String(date.getUTCMinutes()).padStart(2, '0');
      const seconds = String(date.getUTCSeconds()).padStart(2, '0');
      
      return `${year}-${month}-${day} ${hours}:${minutes}:${seconds} UTC`;
    }

    // 解析日期字符串 - 确保纯日期以0点处理
    function parseDateString(dateString) {
      // 先检查是否包含时间部分
      const hasTime = /\s+\d{2}:\d{2}(?::\d{2})?/.test(dateString);
      
      // 尝试多种日期格式
      const formats = [
        // YYYY-MM-DD 格式及带时间的变体
        /^(\d{4})[-/](\d{2})[-/](\d{2})(?:\s+(\d{2}):(\d{2})(?::(\d{2}))?)?$/,
        // DD/MM/YYYY 格式及带时间的变体
        /^(\d{2})[-/](\d{2})[-/](\d{4})(?:\s+(\d{2}):(\d{2})(?::(\d{2}))?)?$/
      ];
      
      for (const format of formats) {
        const match = dateString.match(format);
        if (match) {
          let year, month, day, hours = 0, minutes = 0, seconds = 0;
          
          // 判断是 YYYY-MM-DD 还是 DD/MM/YYYY 格式
          if (parseInt(match[1]) > 1000) {
            // YYYY-MM-DD 格式
            [, year, month, day, hours, minutes, seconds] = match;
          } else {
            // DD/MM/YYYY 格式
            [, day, month, year, hours, minutes, seconds] = match;
          }
          
          // 转换为数字
          year = parseInt(year);
          month = parseInt(month) - 1; // 月份从0开始
          day = parseInt(day);
          hours = hours ? parseInt(hours) : 0;
          minutes = minutes ? parseInt(minutes) : 0;
          seconds = seconds ? parseInt(seconds) : 0;
          
          // 验证日期有效性
          const date = new Date(year, month, day, hours, minutes, seconds);
          if (date.getFullYear() === year && 
              date.getMonth() === month && 
              date.getDate() === day) {
            return date;
          }
        }
      }
      
      return null;
    }

    // 转换函数 - 优先尝试日期解析，避免纯数字日期被误认为时间戳
    function convert() {
      const value = inputValue.value.trim();
      if (!value) {
        showNotification('请输入时间戳或日期', false);
        return;
      }
      
      let timestamp, date;
      let isTimestamp = false;
      
      // 先尝试解析为日期，避免纯数字日期被误认为时间戳
      date = parseDateString(value);
      if (date) {
        timestamp = date.getTime();
      } else {
        // 如果不是日期，再尝试解析为时间戳
        const num = parseFloat(value);
        if (!isNaN(num)) {
          // 10位秒级时间戳
          if (value.length === 10) {
            timestamp = num * 1000;
            date = new Date(timestamp);
            isTimestamp = true;
          } 
          // 13位毫秒级时间戳
          else if (value.length === 13) {
            timestamp = num;
            date = new Date(timestamp);
            isTimestamp = true;
          }
        }
      }
      
      // 检查是否成功解析
      if (!date || isNaN(date.getTime())) {
        showNotification('无法识别的格式，请检查输入', false);
        return;
      }
      
      // 显示结果
      localDateTime.textContent = formatDate(date);
      utcDateTime.textContent = formatUTCDate(date);
      secondTimestamp.textContent = Math.floor(timestamp / 1000);
      millisecondTimestamp.textContent = timestamp;
      
      // 显示结果区域（带动画）
      resultContainer.style.opacity = '1';
    }

    // 事件监听
    clearBtn.addEventListener('click', () => {
      inputValue.value = '';
      inputValue.focus();
      resultContainer.style.opacity = '0';
    });

    convertBtn.addEventListener('click', convert);

    currentMsBtn.addEventListener('click', () => {
      inputValue.value = Date.now();
      convert();
    });

    currentDateBtn.addEventListener('click', () => {
      inputValue.value = formatDate(new Date()).split(' ')[0];
      convert();
    });

    // 复制按钮事件
    copyButtons.forEach(button => {
      button.addEventListener('click', () => {
        const targetId = button.getAttribute('data-target');
        const text = document.getElementById(targetId).textContent;
        if (text && text !== '--') {
          copyToClipboard(text);
        }
      });
    });

    // 回车键触发转换
    inputValue.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        convert();
      }
    });

    // 初始聚焦
    inputValue.focus();
  </script>
  <script src="/floating-ball/load-floating-ball.js"></script>
</body>
</html>

